{% extends 'base.html' %}
{% load static i18n %}

{% block title %}لیست کلاس‌ها | سامانه حضور و غیاب{% endblock %}

{% block content %}
<style>
    :root {
        --primary: #4361ee;
        --secondary: #3a0ca3;
        --accent: #7209b7;
        --success: #4cc9f0;
        --light: #f8f9fa;
        --dark: #212529;
        --white: #ffffff;
        --gray: #6c757d;
        --border: #e9ecef;
        --shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
        --radius: 16px;
        --transition: all 0.3s ease;
    }

    .page-header {
        text-align: center;
        padding: 30px 0;
    }

    .page-title {
        font-size: 28px;
        color: var(--dark);
        margin-bottom: 10px;
    }

    .page-subtitle {
        font-size: 16px;
        color: var(--gray);
    }

    .container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
    }

    .filter-section {
        display: flex;
        justify-content: flex-end;
        margin-bottom: 20px;
    }

    .btn-filter {
        background: var(--primary);
        color: var(--white);
        padding: 10px 20px;
        border-radius: 8px;
        text-decoration: none;
        transition: var(--transition);
    }

    .btn-filter:hover {
        background: var(--secondary);
    }

    .btn-filter.active {
        background: var(--accent);
    }

    .class-table-container {
        background: var(--white);
        border-radius: var(--radius);
        box-shadow: var(--shadow);
        overflow-x: auto;
    }

    .class-table {
        width: 100%;
        border-collapse: collapse;
    }

    .class-table th, .class-table td {
        padding: 15px;
        text-align: right;
        border-bottom: 1px solid var(--border);
    }

    .class-table th {
        background: var(--light);
        color: var(--dark);
        font-weight: bold;
    }

    .class-table tr:hover {
        background: #f1f3f5;
    }

    .btn-attendance {
        background: var(--success);
        color: var(--white);
        padding: 8px 16px;
        border-radius: 8px;
        text-decoration: none;
        transition: var(--transition);
    }

    .btn-attendance:hover {
        background: var(--accent);
    }

    .empty-state {
        text-align: center;
        padding: 50px;
    }

    .empty-state i {
        font-size: 48px;
        color: var(--gray);
        margin-bottom: 20px;
    }

    .alert {
        padding: 10px;
        margin-bottom: 20px;
        border-radius: 8px;
        font-size: 14px;
    }

    .alert-error {
        background: #f8d7da;
        color: #721c24;
        border: 1px solid #f5c6cb;
    }

    .alert-success {
        background: #d4edda;
        color: #155724;
        border: 1px solid #c3e6cb;
    }

    .alert-info {
        background: #d1ecf1;
        color: #0c5460;
        border: 1px solid #bee5eb;
    }
</style>

<!-- Page Header -->
<section class="page-header">
    <div class="page-header-content">
        <h1 class="page-title">لیست کلاس‌ها</h1>
        <p class="page-subtitle">مدیریت کلاس‌های امروز</p>
    </div>
</section>

<div class="container">
    <!-- Filter Section -->
    <div class="filter-section">
        <a href="{% url 'form:class_list' %}?show_all={% if show_all %}0{% else %}1{% endif %}" 
           class="btn-filter {% if show_all %}active{% endif %}">
            {% if show_all %}
                <i class="fas fa-clock"></i> نمایش زنگ فعلی
            {% else %}
                <i class="fas fa-calendar-day"></i> نمایش همه زنگ‌ها
            {% endif %}
        </a>
    </div>

    <!-- Messages -->
    {% if messages %}
        {% for message in messages %}
            <div class="alert alert-{% if message.tags == 'error' %}error{% elif message.tags == 'info' %}info{% else %}success{% endif %}">
                {{ message }}
            </div>
        {% endfor %}
    {% endif %}

    <!-- Class Table -->
    <div class="class-table-container">
        <table class="class-table">
            <thead>
                <tr>
                    <th>کلاس</th>
                    <th>روز</th>
                    <th>زنگ</th>
                    <th>درس</th>
                    <th>واحد</th>
                    <th>عملیات</th>
                </tr>
            </thead>
            <tbody>
                {% for schedule in class_schedules %}
                    <tr>
                        <td>{{ schedule.class_obj.name }}</td>
                        <td>{{ schedule.get_day_display }}</td>
                        <td>{{ schedule.schedule.get_zeng_display }}</td>
                        <td>{{ schedule.subject }}</td>
                        <td>{{ schedule.unit }}</td>
                        <td>
                            <a href="{% url 'form:attendance' schedule.id %}" class="btn-attendance">
                                <i class="fas fa-clipboard-check"></i> ثبت حضور و غیاب
                            </a>
                        </td>
                    </tr>
                {% empty %}
                    <tr>
                        <td colspan="6">
                            <div class="empty-state">
                                <i class="fas fa-calendar-times"></i>
                                <h3>کلاسی یافت نشد</h3>
                                <p>هیچ کلاسی برای امروز ثبت نشده است.</p>
                            </div>
                        </td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // Add active class to filter button based on current state
    const filterButton = document.querySelector('.btn-filter');
    if (filterButton) {
        filterButton.addEventListener('click', function() {
            this.classList.toggle('active');
        });
    }
});
</script>
{% endblock %}